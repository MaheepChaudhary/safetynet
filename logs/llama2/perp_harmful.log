Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.40s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.48s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.62s/it]
Optimal range: [0, 50) - 0/4453 samples (0.0%)
Filtering samples:   0%|          | 0/4453 [00:00<?, ?it/s]Filtering samples:  20%|██        | 895/4453 [00:00<00:00, 8944.49it/s]Filtering samples:  40%|████      | 1797/4453 [00:00<00:00, 8983.96it/s]Filtering samples:  61%|██████    | 2697/4453 [00:00<00:00, 8988.64it/s]Filtering samples:  81%|████████  | 3597/4453 [00:00<00:00, 8991.08it/s]Filtering samples: 100%|██████████| 4453/4453 [00:00<00:00, 9019.11it/s]
Length distribution: Counter({81: 467, 80: 459, 82: 453, 83: 427, 84: 389, 79: 365, 85: 295, 78: 292, 86: 211, 77: 185, 87: 176, 76: 130, 88: 127, 89: 108, 90: 77, 75: 61, 91: 58, 92: 38, 93: 32, 74: 28, 94: 20, 96: 13, 73: 13, 95: 10, 97: 7, 99: 5, 98: 4, 100: 1, 71: 1, 72: 1})
Filtered samples: 0/4453
Calculating perplexity: 0it [00:00, ?it/s]Calculating perplexity: 0it [00:00, ?it/s]
Perplexity calculation complete for llama2 on harmful data
Results saved to: utils/data/llama2/perplexity/harmful.json
